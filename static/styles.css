@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');

:root{
  --bg:#e8edf8;
  --panel:#f5f7fc;
  --accent:#3ac8ba;
  --ink:#0a0a0a;
  --ink-soft:#444;
  --ink-muted:#737373;
  --white:#ffffff;
  --border:#dce1f0;
}

*{box-sizing:border-box}
body{
  margin:0;
  min-height:100vh;
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  background:var(--bg);
  color:var(--ink);
  display:flex;
  justify-content:center;
  align-items:center;
  padding:32px;
}

.file-input-hidden{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  white-space:nowrap;
  border:0;
}

.app{width:min(960px,100%);}

.app__panel{
  background:var(--white);
  border-radius:32px;
  padding:32px;
  box-shadow:0 24px 60px rgba(10,31,68,0.12);
  display:flex;
  flex-direction:column;
  gap:24px;
  height:min(88vh,760px);
}

.app__header{display:flex; flex-wrap:wrap; gap:20px; justify-content:space-between; align-items:flex-start;}
.header__info{display:flex; flex-direction:column; gap:4px; min-width:220px; flex:1 1 220px;}
.title{font-weight:600; font-size:22px; letter-spacing:-0.01em;}
.meta{color:var(--ink-muted); font-size:14px;}
.header__logo{
  flex:1 1 100%;
  display:none;
  justify-content:center;
  align-items:center;
  padding-top:8px;
}
.header__logo img{
  max-height:64px;
  width:auto;
  display:block;
}
.header__logo--visible{display:flex;}

.header__session{
  flex:1 1 240px;
  min-width:220px;
  position:relative;
  display:flex;
  align-items:flex-start;
  justify-content:flex-start;
}
.session-chip{
  position:relative;
  width:100%;
  border:none;
  border-radius:24px;
  padding:12px 40px 12px 16px;
  background:linear-gradient(120deg, rgba(58,200,186,0.18), rgba(58,200,186,0.08));
  color:var(--ink);
  display:flex;
  flex-direction:column;
  gap:4px;
  cursor:pointer;
  box-shadow:0 10px 24px rgba(10,31,68,0.1);
  text-align:left;
  transition:transform .2s ease, box-shadow .2s ease;
}
.session-chip:hover{transform:translateY(-2px); box-shadow:0 14px 32px rgba(10,31,68,0.14);}
.session-chip__primary{font-weight:600; font-size:15px;}
.session-chip__hint{font-size:12px; color:var(--ink-muted);}
.session-chip__chevron{
  position:absolute;
  right:18px;
  top:50%;
  transform:translateY(-50%);
  font-size:18px;
  color:var(--ink-soft);
  opacity:0.6;
}
.session-chip--ephemeral{
  background:linear-gradient(120deg, rgba(244,114,182,0.3), rgba(244,114,182,0.12));
  color:#4a0d2a;
}
.session-chip--ephemeral .session-chip__hint{color:rgba(74,13,42,0.7);}

.session-menu{
  position:absolute;
  top:calc(100% + 10px);
  left:0;
  right:0;
  background:var(--white);
  border-radius:20px;
  box-shadow:0 30px 60px rgba(10,31,68,0.2);
  padding:10px;
  display:flex;
  flex-direction:column;
  gap:8px;
  z-index:30;
  transition:opacity .15s ease, transform .15s ease, visibility .15s ease;
}
.session-menu--hidden{
  opacity:0;
  transform:translateY(-6px);
  pointer-events:none;
  visibility:hidden;
}
.session-menu__item{
  border:none;
  border-radius:16px;
  padding:12px 14px;
  background:var(--panel);
  color:var(--ink);
  text-align:left;
  display:flex;
  flex-direction:column;
  gap:4px;
  cursor:pointer;
  transition:background .15s ease, transform .15s ease;
}
.session-menu__item--active{
  background:var(--white);
  box-shadow:0 0 0 2px rgba(58,200,186,0.25);
}
.session-menu__item:hover{background:var(--white); transform:translateY(-1px);}
.session-menu__title{font-weight:600; font-size:14px;}
.session-menu__subtitle{font-size:12px; color:var(--ink-muted);}

.header__controls{display:flex; flex-direction:column; gap:12px; align-items:flex-end; justify-content:flex-end;}
.header__actions{display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:flex-end;}

.pill-btn{
  border:none;
  border-radius:14px;
  padding:10px 16px;
  font-size:14px;
  font-weight:600;
  background:var(--accent);
  color:#06322d;
  cursor:pointer;
  box-shadow:0 10px 20px rgba(58,200,186,0.28);
  transition:transform .15s ease, box-shadow .15s ease;
}
.pill-btn:hover{transform:translateY(-1px); box-shadow:0 14px 24px rgba(58,200,186,0.32);}
.pill-btn:active{transform:translateY(0);}
.pill-btn--ghost{
  background:rgba(17,24,39,0.08);
  color:var(--ink);
  box-shadow:none;
}
.pill-btn--ghost:hover{background:rgba(17,24,39,0.12);}
.icon-btn{
  width:46px;
  height:46px;
  border:none;
  border-radius:16px;
  background:rgba(17,24,39,0.08);
  color:var(--ink);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:transform .15s ease, box-shadow .15s ease, background .15s ease;
}
.icon-btn:hover{transform:translateY(-1px); box-shadow:0 12px 18px rgba(17,24,39,0.18); background:rgba(17,24,39,0.12);}
.icon-btn:active{transform:translateY(0);}
.icon-btn__icon{font-size:18px; line-height:1;}
.selector{display:flex; flex-direction:column; gap:6px; font-size:13px; color:var(--ink-muted);}
.selector__input{
  min-width:140px;
  height:42px;
  padding:0 12px;
  border-radius:12px;
  border:1px solid var(--border);
  background:var(--white);
  color:var(--ink);
  font-size:14px;
}
.selector__input:focus{outline:none; border-color:var(--accent); box-shadow:0 0 0 3px rgba(58,200,186,0.22);}

.chat{
  background-color:var(--panel);
  border-radius:24px;
  padding:24px;
  overflow-y:auto;
  flex:1;
  display:flex;
  flex-direction:column;
  gap:18px;
  border:1px solid var(--border);
}
.chat--empty{
  background-image:url('/qelion-wrapper-bridge/Inp.png');
  background-repeat:no-repeat;
  background-position:center;
  background-size:clamp(160px, 45%, 320px);
}

.chat::-webkit-scrollbar{width:8px;}
.chat::-webkit-scrollbar-thumb{background:rgba(0,0,0,0.15); border-radius:999px;}

.msg{display:flex; flex-direction:column; gap:12px; max-width:78%;}
.msg__bubble{
  padding:12px 16px;
  border-radius:18px;
  line-height:1.45;
  font-size:15px;
  box-shadow:0 6px 18px rgba(15,38,72,0.08);
  overflow-x:auto;
}

.msg__tools{
  display:flex;
  gap:8px;
  align-items:center;
  margin-top:-4px;
  padding-left:4px;
  justify-content:flex-start;
}
.msg--bot .msg__tools{align-self:flex-start;}

.msg__copy{
  border:none;
  border-radius:12px;
  padding:6px 12px;
  font-size:12px;
  font-weight:600;
  background:rgba(17,24,39,0.08);
  color:var(--ink);
  cursor:pointer;
  transition:background .15s ease, transform .15s ease;
  display:inline-flex;
  gap:6px;
  align-items:center;
}
.msg__copy:hover{background:rgba(17,24,39,0.12); transform:translateY(-1px);}
.msg__copy:active{transform:translateY(0);}

.msg--streaming .msg__bubble{
  position:relative;
  white-space:pre-wrap;
}
.msg--streaming .msg__bubble::after{
  content:'';
  display:inline-block;
  width:3px;
  height:1.2em;
  background:currentColor;
  margin-left:4px;
  border-radius:1px;
  animation:caretBlink 1s steps(1) infinite;
  vertical-align:bottom;
}

.msg__bubble p{
  margin:0 0 0.65em;
}
.msg__bubble p:last-child{
  margin-bottom:0;
}
.msg__bubble ul,
.msg__bubble ol{
  margin:0 0 0.65em 1.4em;
  padding:0;
}
.msg__bubble li + li{
  margin-top:0.25em;
}
.msg__bubble a{
  color:#2563eb;
  text-decoration:none;
}
.msg__bubble a:hover{
  text-decoration:underline;
}
.msg__bubble code{
  font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
  font-size:0.95em;
  background:rgba(15,23,42,0.12);
  padding:0.1em 0.35em;
  border-radius:6px;
}
.msg__bubble pre{
  margin:0 0 0.8em;
  padding:12px 14px;
  background:#0f172a;
  color:#f8fafc;
  border-radius:12px;
  overflow:auto;
  font-size:0.92em;
  line-height:1.55;
}
.msg__bubble pre code{
  background:transparent;
  padding:0;
  color:inherit;
}
.msg__bubble blockquote{
  margin:0 0 0.75em;
  padding-left:14px;
  border-left:3px solid rgba(37,99,235,0.45);
  color:rgba(15,23,42,0.85);
}
.msg__bubble table{
  width:100%;
  border-collapse:collapse;
  margin:0.6em 0;
  font-size:0.95em;
}
.msg__bubble th,
.msg__bubble td{
  border:1px solid rgba(15,23,42,0.08);
  padding:6px 8px;
  text-align:left;
}
.msg__bubble th{
  background:rgba(37,99,235,0.08);
  font-weight:600;
}
.katex{
  font-size:1.02em;
}
.katex-display{
  margin:0.7em 0;
}

.msg--user{align-self:flex-end;}
.msg--user .msg__bubble{
  background:#111827;
  color:#f9fafb;
  border-bottom-right-radius:8px;
}
.msg--bot{align-self:flex-start;}
.msg--bot .msg__bubble{
  background:var(--white);
  color:var(--ink-soft);
  border-bottom-left-radius:8px;
}

.msg__files{display:flex; flex-wrap:wrap; gap:8px;}
.thumb{
  display:inline-flex;
  align-items:center;
  gap:8px;
  background:#111827;
  color:#f9fafb;
  padding:6px 10px;
  border-radius:10px;
  font-size:12px;
  box-shadow:0 4px 12px rgba(17,24,39,0.35);
}
.thumb img{height:28px; width:28px; object-fit:cover; border-radius:6px;}

.msg__warning{
  font-size:12px;
  color:#b45309;
  background:rgba(250,204,21,0.18);
  border:1px solid rgba(202,138,4,0.25);
  border-radius:12px;
  padding:8px 12px;
}

.msg__thoughts{
  background:rgba(58,200,186,0.12);
  border-radius:14px;
  border:1px solid rgba(58,200,186,0.2);
  overflow:hidden;
}

.msg__thoughts summary{
  cursor:pointer;
  padding:10px 14px;
  font-weight:600;
  font-size:13px;
  color:#067a70;
  list-style:none;
}

.msg__thoughts[open] summary{border-bottom:1px solid rgba(58,200,186,0.25);}

.msg__thoughts summary::-webkit-details-marker{display:none;}

.msg__thoughts-body{
  padding:12px 14px 16px;
  font-size:13px;
  line-height:1.4;
  white-space:pre-wrap;
  color:#0b3a36;
}

.composer{
  display:flex;
  gap:12px;
  align-items:center;
  background:var(--panel);
  padding:16px;
  border-radius:20px;
  border:1px solid var(--border);
}

.add-btn{display:block;}
.add-btn__circle{
  display:inline-grid;
  place-items:center;
  width:44px;
  height:44px;
  border-radius:16px;
  background:#111827;
  color:#f9fafb;
  font-size:24px;
  font-weight:700;
  transition:transform .2s ease,box-shadow .2s ease;
  box-shadow:0 10px 20px rgba(15,23,42,0.2);
}
.add-btn__circle:hover{transform:translateY(-1px); box-shadow:0 14px 26px rgba(15,23,42,0.22);}

.prompt{
  flex:1;
  height:48px;
  border-radius:14px;
  border:1px solid var(--border);
  outline:none;
  padding:0 16px;
  background:var(--white);
  color:var(--ink);
  font-size:16px;
  transition:border-color .2s ease, box-shadow .2s ease;
}
.prompt:focus{border-color:var(--accent); box-shadow:0 0 0 4px rgba(58,200,186,0.28);}

.send{
  width:52px;
  height:48px;
  padding:0;
  border:none;
  border-radius:16px;
  background:var(--accent);
  color:#06322d;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 12px 20px rgba(58,200,186,0.35);
  cursor:pointer;
  transition:transform .2s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
}
.send__icon{
  font-size:20px;
  font-weight:700;
  line-height:1;
  transition:transform .2s ease, opacity .2s ease;
}
.send:hover{transform:translateY(-1px); box-shadow:0 16px 28px rgba(58,200,186,0.4);}
.send--streaming{
  background:#111827;
  color:#f9fafb;
  box-shadow:0 14px 28px rgba(17,23,42,0.35);
}
.send--streaming:hover{box-shadow:0 18px 32px rgba(17,23,42,0.4);}
.send--streaming .send__icon{animation:dotPulse 1s infinite ease-in-out;}

.placeholder{
  text-align:center;
  color:var(--ink-muted);
  font-size:14px;
}

.picker{
  position:fixed;
  inset:0;
  background:rgba(10,20,40,0.35);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  transition:opacity .2s ease, visibility .2s ease;
  z-index:20;
}
.picker--hidden{opacity:0; visibility:hidden; pointer-events:none;}
.picker__card{
  background:var(--white);
  width:100%;
  max-width:360px;
  border-radius:20px;
  padding:24px;
  box-shadow:0 20px 48px rgba(12,32,68,0.28);
  display:flex;
  flex-direction:column;
  gap:18px;
  align-items:stretch;
}
.picker__title{font-size:18px; font-weight:600; text-align:center;}
.picker__options{display:flex; flex-direction:column; gap:12px;}
.picker__btn{
  display:flex;
  align-items:center;
  gap:10px;
  justify-content:center;
  border:none;
  border-radius:14px;
  padding:12px;
  font-size:15px;
  font-weight:600;
  cursor:pointer;
  background:var(--panel);
  color:var(--ink);
  transition:transform .15s ease, box-shadow .15s ease;
}
.picker__btn:hover{transform:translateY(-1px); box-shadow:0 10px 20px rgba(10,20,40,0.16);}
.picker__close{
  border:none;
  background:none;
  color:var(--ink-muted);
  font-size:14px;
  cursor:pointer;
  align-self:center;
}

.history,
.settings{
  position:fixed;
  inset:0;
  background:rgba(10,20,40,0.35);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
  transition:opacity .2s ease, visibility .2s ease;
  z-index:22;
}
.history--hidden,
.settings--hidden{opacity:0; visibility:hidden; pointer-events:none;}
.history__card,
.settings__card{
  background:var(--white);
  width:min(420px,100%);
  border-radius:20px;
  padding:24px;
  box-shadow:0 24px 52px rgba(12,32,68,0.3);
  display:flex;
  flex-direction:column;
  gap:18px;
}
.history__header,
.settings__header{display:flex; justify-content:space-between; align-items:center;}
.history__title,
.settings__title{font-size:18px; font-weight:600;}
.history__close,
.settings__close{
  border:none;
  background:none;
  color:var(--ink-muted);
  font-size:14px;
  cursor:pointer;
}
.history__list{display:flex; flex-direction:column; gap:10px; max-height:360px; overflow:auto;}
.history__empty{font-size:14px; color:var(--ink-muted); text-align:center; padding:16px 0;}
.history__item{display:flex; align-items:center; gap:8px; background:var(--panel); padding:10px 12px; border-radius:14px; border:1px solid var(--border);}
.history__entry{
  flex:1;
  text-align:left;
  background:none;
  border:none;
  color:var(--ink);
  cursor:pointer;
  display:flex;
  flex-direction:column;
  gap:4px;
}
.history__entry-title{font-size:14px; font-weight:600; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
.history__entry-meta{font-size:12px; color:var(--ink-muted);}
.history__item--active{border-color:var(--accent); box-shadow:0 0 0 3px rgba(58,200,186,0.22);}
.history__delete{
  border:none;
  background:none;
  cursor:pointer;
  font-size:16px;
  color:#ef4444;
  line-height:1;
  display:flex;
  align-items:center;
  justify-content:center;
}
.history__delete:hover{transform:scale(1.05);}

.settings__content{display:flex; flex-direction:column; gap:16px;}

@keyframes caretBlink{
  0%,50%{opacity:1;}
  50.01%,100%{opacity:0;}
}

@keyframes dotPulse{
  0%,100%{opacity:0.6; transform:translateY(0);}
  50%{opacity:1; transform:translateY(-1px);}
}

.thumb--doc{background:#2563eb;}
.thumb--pdf{background:#ef4444;}
.thumb--doc,.thumb--pdf{box-shadow:0 6px 16px rgba(15,23,42,0.28);}
.thumb--doc span,
.thumb--pdf span{color:#fff; font-weight:600;}

@media (max-width: 860px){
  body{padding:24px;}
  .app__panel{padding:24px;}
  .header__controls{width:100%; align-items:stretch;}
  .header__actions{justify-content:flex-start;}
  .selector__input{width:100%;}
  .composer{flex-direction:column; align-items:stretch;}
  .send{width:100%;}
  .history__card,
  .settings__card{width:100%; max-width:100%;}
}

@media (max-width: 540px){
  body{padding:16px;}
  .app__panel{border-radius:20px;}
  .chat{padding:18px;}
}

body.is-mobile{
  display:block;
  padding:0;
  min-height:100vh;
  background:#050505;
  color:#f4f4f5;
}
body.is-mobile .app{
  width:100%;
  min-height:100vh;
}
body.is-mobile .app__panel{
  width:100%;
  border-radius:0;
  box-shadow:none;
  min-height:100vh;
  height:auto;
  padding:0 0 calc(150px + env(safe-area-inset-bottom));
  gap:0;
  background:transparent;
}
body.is-mobile .app__header{
  position:sticky;
  top:0;
  z-index:8;
  display:flex;
  flex-direction:column;
  gap:8px;
  padding:20px 20px 12px;
  background:linear-gradient(180deg, rgba(5,5,5,0.95), rgba(5,5,5,0.4));
  backdrop-filter:blur(12px);
  border-bottom:1px solid rgba(255,255,255,0.05);
}
body.is-mobile .header__info{min-width:0;}
body.is-mobile .title{color:#fff;}
body.is-mobile .meta{color:rgba(255,255,255,0.65);}
body.is-mobile .header__controls{
  width:100%;
  align-items:stretch;
}
body.is-mobile .header__actions{
  width:100%;
  justify-content:space-between;
}
body.is-mobile .pill-btn,
body.is-mobile .pill-btn--ghost{
  flex:1;
  text-align:center;
}
body.is-mobile .header__session{
  order:3;
  width:100%;
}
body.is-mobile .session-chip{
  background:rgba(255,255,255,0.08);
  color:#fff;
  box-shadow:none;
  padding:14px 48px 14px 18px;
  border:1px solid rgba(255,255,255,0.12);
}
body.is-mobile .session-chip__hint{color:rgba(255,255,255,0.65);}
body.is-mobile .session-chip__chevron{color:#fff; right:24px;}
body.is-mobile .session-chip--ephemeral{
  background:rgba(244,114,182,0.2);
  color:#ffe9f3;
}
body.is-mobile .header__logo{
  order:4;
  padding-top:6px;
}
body.is-mobile .chat{
  border-radius:28px;
  padding:16px;
  margin:12px 20px;
  background:#080808;
  border:1px solid rgba(255,255,255,0.08);
  color:#f5f5f5;
}
body.is-mobile .chat--empty{
  background-size:clamp(120px,45%,220px);
  opacity:0.7;
}
body.is-mobile .composer{
  position:fixed;
  left:0;
  right:0;
  bottom:0;
  border-radius:28px 28px 0 0;
  border:none;
  border-top:1px solid rgba(255,255,255,0.07);
  background:rgba(5,5,5,0.95);
  box-shadow:0 -12px 30px rgba(0,0,0,0.45);
  padding:14px 18px calc(24px + env(safe-area-inset-bottom));
  flex-direction:column;
  align-items:stretch;
  gap:10px;
}
body.is-mobile .add-btn__circle{
  width:48px;
  height:48px;
  border-radius:999px;
  background:rgba(255,255,255,0.08);
  color:#f5f5f5;
  box-shadow:none;
}
body.is-mobile .prompt{
  width:100%;
  height:46px;
  font-size:16px;
  border:none;
  background:rgba(255,255,255,0.12);
  color:#fff;
}
body.is-mobile .prompt::placeholder{color:rgba(255,255,255,0.5);}
body.is-mobile .send{
  width:100%;
  height:52px;
}
body.is-mobile .history,
body.is-mobile .settings,
body.is-mobile .picker{
  padding:0;
}
body.is-mobile .history__card,
body.is-mobile .settings__card,
body.is-mobile .picker__card{
  width:100%;
  max-width:none;
  height:100%;
  border-radius:0;
}
body.is-mobile .session-menu{
  position:fixed;
  left:16px;
  right:16px;
  top:auto;
  bottom:calc(130px + env(safe-area-inset-bottom));
  background:#111;
  border:1px solid rgba(255,255,255,0.08);
  box-shadow:0 24px 60px rgba(0,0,0,0.6);
}
body.is-mobile .session-menu__item{
  background:rgba(255,255,255,0.05);
  color:#f5f5f5;
}
body.is-mobile .session-menu__subtitle{color:rgba(255,255,255,0.55);}
body.is-mobile .session-menu__item:hover{background:rgba(255,255,255,0.12);}
body.is-mobile .session-menu__item--active{
  background:rgba(255,255,255,0.18);
  box-shadow:0 0 0 2px rgba(255,255,255,0.18);
}
